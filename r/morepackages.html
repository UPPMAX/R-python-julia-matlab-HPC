

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>More about R packages &mdash; Introduction to running R, Python, Julia and MATLAB in HPC 2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx_lesson.css?v=e9df6548" />
      <link rel="stylesheet" type="text/css" href="../_static/term_role_formatting.css?v=4194e21c" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx_rtd_theme_ext_color_contrast.css?v=8e8ea19f" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=a5c4661c" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=60dbed4a"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=6dbb43f8"></script>
      <script src="../_static/minipres.js?v=a0d29692"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script src="../_static/design-tabs.js?v=f930bc37"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script src="../_static/tabs.js?v=3030b3cb"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Packages at Bianca (parallel session)" href="packagesBianca.html" />
    <link rel="prev" title="Isolated environments, extra exercises" href="../extra/isolated_extra.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Introduction to running R, Python, Julia and MATLAB in HPC
              <img src="../_static/hpc2n-lunarc-uppmax-hpc-course.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Pre-requirements:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../prereqs.html">Pre-requirements</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">COMMON:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../common/login.html">Log in session</a></li>
<li class="toctree-l1"><a class="reference internal" href="../common/ondemand-desktop.html">Desktop On Demand</a></li>
<li class="toctree-l1"><a class="reference internal" href="../common/use_tarball.html">Use the tarball with exercises</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python Lessons:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../python/intro.html">Introduction Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/load_runPython.html">Load and run python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/packages.html">Python packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/isolated.html">Isolated environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/batchPython.html">Running Python in batch mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/GPU.html">Using GPUs with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/interactivePython.html">Interactive work on the compute nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/jupyter.html">Jupyter on compute nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../common/parallel.html">Parallel and multithreaded functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/condaUPPMAX.html">Conda at UPPMAX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/summaryPython.html">Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/evaluationPython.html">Evaluation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Julia Lessons:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../julia/introJulia.html">Introduction Julia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../julia/load_runJulia.html">Load and run Julia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../julia/isolatedJulia.html">Packages and isolated environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../julia/batchJulia.html">Running Julia in batch mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../common/parallel.html">Parallel and multithreaded functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../julia/interactiveJulia.html">Sessions: Interactive work on compute nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../julia/summaryJulia.html">Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../julia/evaluationJulia.html">Evaluation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">R Lessons:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introR.html">Introduction R</a></li>
<li class="toctree-l1"><a class="reference internal" href="load_runR.html">Load and run R</a></li>
<li class="toctree-l1"><a class="reference internal" href="packagesR.html">Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="isolatedR.html">Isolated environments with <code class="docutils literal notranslate"><span class="pre">renv</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="batchR.html">Running R in batch mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../common/parallel.html">Parallel and multithreaded functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="interactiveR.html">Interactive work on the compute nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="rstudio.html">Using RStudio</a></li>
<li class="toctree-l1"><a class="reference internal" href="MLR.html">ML with R</a></li>
<li class="toctree-l1"><a class="reference internal" href="summaryR.html">Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="evaluationR.html">Evaluation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Matlab Lessons:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../matlab/introMatlab.html">Introduction to MATLAB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../matlab/load_runMatlab.html">Load and Run MATLAB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../matlab/slurmMatlab.html">Slurm job scheduler and MATLAB in terminal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../matlab/jobsMatlab.html">MATLAB GUI and SLURM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../common/parallel.html">Parallel and multithreaded functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../matlab/add_onsMatlab.html">Add-Ons</a></li>
<li class="toctree-l1"><a class="reference internal" href="../matlab/local_desktopMatlab.html">Session-UPPMAX: Matlab client on the desktop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../matlab/jupyterMatlab.html">Session: Matlab in Jupyter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../matlab/summaryMatlab.html">Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../matlab/evaluationMatlab.html">Evaluation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extra reading:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../extra/isolated_extra.html">Isolated environments, extra exercises</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">More about R packages</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#r-packages-a-short-primer">R packages: A short Primer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-is-a-package-really">What is a package, really?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#package-states">Package states</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#finding-out-if-an-r-package-is-installed">Finding out if an R package is installed</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-your-own-packages">Installing your own packages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#setup">Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#automatical-download-and-install-from-cran">Automatical download and install from CRAN</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#automatic-download-and-install-from-github">Automatic download and install from GitHub</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#manual-download-and-install">Manual download and install</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#install-own-packages-on-bianca">Install own packages on Bianca</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="packagesBianca.html">Packages at Bianca (parallel session)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extra/matlab.html">Extra reading about MATLAB in HPC</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Introduction to running R, Python, Julia and MATLAB in HPC</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">More about R packages</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/UPPMAX/R-python-julia-MATLAB-HPC/blob/main/docs/r/morepackages.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="more-about-r-packages">
<h1>More about R packages<a class="headerlink" href="#more-about-r-packages" title="Link to this heading"></a></h1>
<p>This page contains some more advanced information about R packages.</p>
<section id="r-packages-a-short-primer">
<h2>R packages: A short Primer<a class="headerlink" href="#r-packages-a-short-primer" title="Link to this heading"></a></h2>
<section id="what-is-a-package-really">
<h3>What is a package, really?<a class="headerlink" href="#what-is-a-package-really" title="Link to this heading"></a></h3>
<p>An R package is essentially a contained folder and file structure containing R
code (and possibly C/C++ or other code) and other files relevant for the
package e.g. documentation(vignettes), licensing and configuration files. Let
us look at a very simple example</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/MatPiq/R_example.git

<span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>R_example

<span class="gp">$ </span>tree
<span class="go">.</span>
<span class="go">├── DESCRIPTION</span>
<span class="go">├── NAMESPACE</span>
<span class="go">├── R</span>
<span class="go">│   └── hello.R</span>
<span class="go">├── man</span>
<span class="go">│   └── hello.Rd</span>
<span class="go">└── r_example.Rproj</span>
</pre></div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Installing tree as non-root on Linux Ubuntu</p>
<blockquote>
<div><p>If you are on a Linux Ubuntu system where tree is not installed, and you do not have root permissions, you can do this to install it in your own area</p>
<ol class="arabic simple">
<li><p>Create a directory (in your home folder) to install in:</p></li>
</ol>
<p>Change to that directory:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cd ~/mytree</span>
</pre></div>
</div>
<p>Now download tree:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">apt download tree</span>
</pre></div>
</div>
<p>Unpack the files:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">dpkg-deb -xv ./*deb ./</span>
</pre></div>
</div>
<p>You can use tree like this now, giving the full path:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">~/mytree/usr/bin/tree</span>
</pre></div>
</div>
<p><strong>Note</strong>: if you want to be able to use it with the command “tree” you could set an alias in your ~/.bashrc file and then <code class="docutils literal notranslate"><span class="pre">source</span></code> it:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">echo &#39;alias tree=&quot;$HOME/mytree/usr/bin/tree&quot;&#39; &gt;&gt; ~/.bashrc</span>
<span class="go">source ~/.bashrc</span>
</pre></div>
</div>
</div></blockquote>
</div>
</section>
<section id="package-states">
<h3>Package states<a class="headerlink" href="#package-states" title="Link to this heading"></a></h3>
<p>An R packages can exist in five possible states</p>
<ul class="simple">
<li><p>Source: “source code” or “source files”. Development form.</p></li>
<li><p>Bundled: The source code compressed into a single file, usually <cite>tar.gz</cite> and
sometimes referred to as “source tarballs”. Files in <cite>.Rbuildignore</cite> are
excluded.</p></li>
<li><p>Binary: A compressed and pre-compiled version of a bundle built for a
specific architecture. Usually how the package is provided by CRAN. Much
faster than having to compile yourself and no need for dev/build tools.</p></li>
<li><p>Installed: A decompressed binary package located in a package _library_ (more
on this later).</p></li>
<li><p>In-memory: When the installed package has been loaded from the library into
memory, using <cite>require(pkg)</cite> or <cite>library(pkg)</cite>.</p></li>
</ul>
<figure class="align-left">
<a class="reference internal image-reference" href="../_images/R-pkg-states.png"><img alt="../_images/R-pkg-states.png" src="../_images/R-pkg-states.png" style="width: 600px;" />
</a>
</figure>
<p><span class="raw-html"><br /></span>
<span class="raw-html"><br /></span>
<span class="raw-html"><br /></span>
<span class="raw-html"><br /></span>
<span class="raw-html"><br /></span>
<span class="raw-html"><br /></span>
<span class="raw-html"><br /></span>
<span class="raw-html"><br /></span>
<span class="raw-html"><br /></span>
<span class="raw-html"><br /></span>
<span class="raw-html"><br /></span>
<span class="raw-html"><br /></span></p>
<div class="line-block">
<div class="line">Source:</div>
<div class="line"><a class="reference external" href="https://r-pkgs.org/structure.html">https://r-pkgs.org/structure.html</a> and</div>
<div class="line"><a class="reference external" href="https://nbisweden.github.io/RaukR-2021/rpackages_Sebastian/presentation/rpackages_Sebastian.html">https://nbisweden.github.io/RaukR-2021/rpackages_Sebastian/presentation/rpackages_Sebastian.html</a></div>
</div>
</section>
</section>
<section id="finding-out-if-an-r-package-is-installed">
<h2>Finding out if an R package is installed<a class="headerlink" href="#finding-out-if-an-r-package-is-installed" title="Link to this heading"></a></h2>
<p>There are many different ways to check if the package you are after is already installed - chances are it is! The simplest way is probably to simply try loading the package from within R</p>
<p><code class="docutils literal notranslate"><span class="pre">library(package-name)</span></code></p>
<p>Another option would be to create a dataframe of all the installed packages</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">ip</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">installed.packages</span><span class="p">()[,</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="o">:</span><span class="m">4</span><span class="p">)])</span>

<span class="nf">rownames</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NULL</span>

<span class="n">ip</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ip</span><span class="p">[</span><span class="nf">is.na</span><span class="p">(</span><span class="n">ip</span><span class="o">$</span><span class="n">Priority</span><span class="p">),</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span><span class="n">drop</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">]</span>

<span class="nf">print</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
<p>However, this might not be so helpful unless you do additional filtering.
&lt;br&gt;</p>
<p>Another simple option is to <code class="docutils literal notranslate"><span class="pre">grep</span></code> the library directory. For example, both when loading <code class="docutils literal notranslate"><span class="pre">R_packages</span></code> at UPPMAX and <code class="docutils literal notranslate"><span class="pre">R-bundle-Bioconductor</span></code> at HPC2N the environment variable <code class="docutils literal notranslate"><span class="pre">R_LIBS_SITE</span></code> will be set to the path of the package
library.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">UPPMAX</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">HPC2N</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><p>Load <code class="docutils literal notranslate"><span class="pre">R_packages</span></code></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ml<span class="w"> </span>R_packages/4.1.1
</pre></div>
</div>
<p>Then grep for some package</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ls<span class="w"> </span>-l<span class="w"> </span><span class="nv">$R_LIBS_SITE</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>glmnet
<span class="go">dr-xr-sr-x  9 douglas sw  4096 Sep  6  2021 EBglmnet</span>
<span class="go">dr-xr-sr-x 11 douglas sw  4096 Nov 11  2021 glmnet</span>
<span class="go">dr-xr-sr-x  8 douglas sw  4096 Sep  7  2021 glmnetcr</span>
<span class="go">dr-xr-sr-x  7 douglas sw  4096 Sep  7  2021 glmnetUtils</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><p>Load <code class="docutils literal notranslate"><span class="pre">R-bundle-Bioconductor</span></code></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ml<span class="w"> </span>GCC/11.2.0<span class="w">  </span>OpenMPI/4.1.1<span class="w"> </span>R-bundle-Bioconductor/3.14-R-4.1.2
</pre></div>
</div>
<p>Check the <code class="docutils literal notranslate"><span class="pre">R_LIBS_SITE</span></code> environment variable</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$R_LIBS_SITE</span>
<span class="go">/hpc2n/eb/software/R-bundle-Bioconductor/3.14-foss-2021b-R-4.1.2:/hpc2n/eb/software/arrow-R/6.0.0.2-foss-2021b-R-4.1.2</span>
</pre></div>
</div>
<p>Then grep for some package in the BioConductor package library</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ls<span class="w"> </span>-l<span class="w"> </span>/hpc2n/eb/software/R-bundle-Bioconductor/3.14-foss-2021b-R-4.1.2<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>RNA
<span class="go">drwxr-xr-x  9 easybuild easybuild 4096 Dec 30  2021 DeconRNASeq/</span>
<span class="go">drwxr-xr-x  7 easybuild easybuild 4096 Dec 30  2021 RNASeqPower/</span>
</pre></div>
</div>
</div></div>
</section>
<section id="installing-your-own-packages">
<h2>Installing your own packages<a class="headerlink" href="#installing-your-own-packages" title="Link to this heading"></a></h2>
<p>Sometimes you will need R packages that are not already installed. The solution
to this is to install your own packages. These packages will usually come from
CRAN (<a class="reference external" href="https://cran.r-project.org/">https://cran.r-project.org/</a>) - the Comprehensive R Archive Network, or
sometimes from other places, like GitHub or R-Forge</p>
<p>Here we will look at installing R packages with automatic download and with
manual download. It is also possible to install from inside Rstudio.</p>
<section id="setup">
<h3>Setup<a class="headerlink" href="#setup" title="Link to this heading"></a></h3>
<p>We need to create a place for the own-installed packages to be and to tell R
where to find them. The initial setup only needs to be done once, but separate
package directories need to be created for each R version used.</p>
<p>R reads the <code class="docutils literal notranslate"><span class="pre">$HOME/.Renviron</span></code> file to setup its environment. It should be
created by R on first run, or you can create it with the command: <code class="docutils literal notranslate"><span class="pre">touch</span>
<span class="pre">$HOME/.Renviron</span></code></p>
<p><strong>NOTE</strong>: In this example we are going to assume you have chosen to place the R packages in a directory under your home directory, but in general it might be good to use the project storage for space reasons. As mentioned, you will need
separate ones for each R version.</p>
<p>If you have not yet installed any packages to R yourself, the environment file should be empty and you can update it like this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">echo</span><span class="w"> </span><span class="nv">R_LIBS_USER</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/R-packages-%V&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>~/.Renviron
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>If it is <strong>not empty</strong>, you can edit <code class="docutils literal notranslate"><span class="pre">$HOME/.Renviron</span></code> with your favorite editor so that <code class="docutils literal notranslate"><span class="pre">R_LIBS_USER</span></code> contains the path to your chosen directory for own-installed R packages.</p></li>
</ul>
</div>
<p>It should look something like this when you are done:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nv">R_LIBS_USER</span><span class="o">=</span><span class="s2">&quot;/home/u/user/R-packages-%V&quot;</span>
</pre></div>
</div>
<p><strong>NOTE</strong> Replace <code class="docutils literal notranslate"><span class="pre">/home/u/user</span></code> with the value of <code class="docutils literal notranslate"><span class="pre">$HOME</span></code>. Run <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">$HOME</span></code> to see its value.
<strong>NOTE</strong> The <code class="docutils literal notranslate"><span class="pre">%V</span></code> should be written as-is, it’s substituted at runtime with the active R version.</p>
<p>For each version of R you are using, create a directory matching the pattern
used in <code class="docutils literal notranslate"><span class="pre">.Renviron</span></code> to store your packages in. This example is shown for R
version 4.1.1:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span><span class="nv">$HOME</span>/R-packages-4.1.1
</pre></div>
</div>
</section>
<section id="automatical-download-and-install-from-cran">
<h3>Automatical download and install from CRAN<a class="headerlink" href="#automatical-download-and-install-from-cran" title="Link to this heading"></a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You find a list of packages in CRAN (<a class="reference external" href="https://cran.r-project.org/">https://cran.r-project.org/</a>) and a list of repos here: <a class="reference external" href="https://cran.r-project.org/mirrors.html">https://cran.r-project.org/mirrors.html</a></p>
<p>Please choose a location close to you when picking a repo.</p>
</div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-1-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-1-1-0" name="1-0" role="tab" tabindex="0">From command line</button><button aria-controls="panel-1-1-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-1" name="1-1" role="tab" tabindex="-1">From inside R</button></div><div aria-labelledby="tab-1-1-0" class="sphinx-tabs-panel" id="panel-1-1-0" name="1-0" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>R<span class="w"> </span>--quiet<span class="w"> </span>--no-save<span class="w"> </span>--no-restore<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;install.packages(&#39;&lt;r-package&gt;&#39;, repos=&#39;&lt;repo&gt;&#39;)&quot;</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-1-1" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-1" name="1-1" role="tabpanel" tabindex="0"><div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">install.packages</span><span class="p">(</span><span class="s">&#39;&lt;r-package&gt;&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">repos</span><span class="o">=</span><span class="s">&#39;&lt;repo&gt;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<p>In either case, the dependencies of the package will be downloaded and
installed as well.</p>
<section id="example">
<h4>Example<a class="headerlink" href="#example" title="Link to this heading"></a></h4>
<p>In this example, we will install the R package <code class="docutils literal notranslate"><span class="pre">stringr</span></code> and use the
repository <a class="reference external" href="http://ftp.acc.umu.se/mirror/CRAN/">http://ftp.acc.umu.se/mirror/CRAN/</a></p>
<p><strong>Note</strong>: You need to load R (and any prerequisites, and possibly R-bundle-Bioconductor if you need packages from that) before installing packages.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-2-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-2-2-0" name="2-0" role="tab" tabindex="0">From command line</button><button aria-controls="panel-2-2-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-2-2-1" name="2-1" role="tab" tabindex="-1">From inside R</button></div><div aria-labelledby="tab-2-2-0" class="sphinx-tabs-panel" id="panel-2-2-0" name="2-0" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>R<span class="w"> </span>--quiet<span class="w"> </span>--no-save<span class="w"> </span>--no-restore<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;install.packages(&#39;stringr&#39;, repos=&#39;http://ftp.acc.umu.se/mirror/CRAN/&#39;)&quot;</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-2-1" class="sphinx-tabs-panel" hidden="true" id="panel-2-2-1" name="2-1" role="tabpanel" tabindex="0"><div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">install.packages</span><span class="p">(</span><span class="s">&#39;stringr&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">repos</span><span class="o">=</span><span class="s">&#39;http://ftp.acc.umu.se/mirror/CRAN/&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<p>For other ways to install R packages, including from GitHub, look at the “More about R packages” from the “Extra reading” section in the bottom left side of the menu.</p>
</section>
</section>
<section id="automatic-download-and-install-from-github">
<h3>Automatic download and install from GitHub<a class="headerlink" href="#automatic-download-and-install-from-github" title="Link to this heading"></a></h3>
<p>If you want to install a package that is not on CRAN, but which do have a
GitHub page, then there is an automatic way of installing, but you need to
handle prerequsites yourself by installing those first. It can also be that the
package is not in as finished a state as those on CRAN, so be careful.</p>
<p>To install packages from GitHub directly, from inside R, you first need to
install the devtools package. Note that you only need to install this <strong>once</strong>.</p>
<p>This is how you install a package from GitHub, inside R:</p>
<blockquote>
<div><div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;devtools&quot;</span><span class="p">)</span><span class="w">   </span><span class="c1"># ONLY ONCE</span>
<span class="n">devtools</span><span class="o">::</span><span class="nf">install_github</span><span class="p">(</span><span class="s">&quot;DeveloperName/package&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<section id="id1">
<h4>Example<a class="headerlink" href="#id1" title="Link to this heading"></a></h4>
<div class="admonition-type-along type-along important admonition" id="type-along-0">
<p class="admonition-title">Type-Along</p>
<p>In this example we want to install the package <code class="docutils literal notranslate"><span class="pre">quantstrat</span></code>. It is not on CRAN, so let’s get it from the GitHub page for the project:
<a class="reference external" href="https://github.com/braverock/quantstrat">https://github.com/braverock/quantstrat</a></p>
<p>We also need to install devtools so we can install packages from GitHub. In
addition, <code class="docutils literal notranslate"><span class="pre">quantstrat</span></code> has some prerequisites, some on CRAN, some on GitHub,
so we need to install those as well.</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;devtools&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1"># ONLY ONCE</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;FinancialInstrument&quot;</span><span class="p">)</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;PerformanceAnalytics&quot;</span><span class="p">)</span>

<span class="n">devtools</span><span class="o">::</span><span class="nf">install_github</span><span class="p">(</span><span class="s">&quot;braverock/blotter&quot;</span><span class="p">)</span>
<span class="n">devtools</span><span class="o">::</span><span class="nf">install_github</span><span class="p">(</span><span class="s">&quot;braverock/quantstrat&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="manual-download-and-install">
<h3>Manual download and install<a class="headerlink" href="#manual-download-and-install" title="Link to this heading"></a></h3>
<p>If the package is not on CRAN or you want the development version, or you for
other reason want to install a package you downloaded, then this is how to
install from the command line:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>R<span class="w"> </span>CMD<span class="w"> </span>INSTALL<span class="w"> </span>-l<span class="w"> </span>&lt;path-to-R-package&gt;/R-package.tar.gz
</pre></div>
</div>
<p><strong>NOTE</strong> that if you install a package this way, you need to handle any
dependencies yourself.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Places to look for R packages</p>
<ul class="simple">
<li><p>CRAN (<a class="reference external" href="https://cran.r-project.org/">https://cran.r-project.org/</a>)</p></li>
<li><p>R-Forge (<a class="reference external" href="https://r-forge.r-project.org/">https://r-forge.r-project.org/</a>)</p></li>
<li><p>Project’s own GitHub page</p></li>
<li><p>etc.</p></li>
</ul>
</div>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ul class="simple">
<li><dl class="simple">
<dt>You can check for installed packages</dt><dd><ul>
<li><p>from inside R with <code class="docutils literal notranslate"><span class="pre">installed.packages()</span></code></p></li>
<li><dl class="simple">
<dt>from BASH shell with the</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">ml</span> <span class="pre">help</span> <span class="pre">R/&lt;version&gt;</span></code> at UPPMAX</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ml</span> <span class="pre">spider</span> <span class="pre">R/&lt;version&gt;</span></code> at HPC2N</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><p>Installation of R packages can be done either from within R or from the
command line (BASH shell)</p></li>
<li><p>CRAN is the recommended place to look for R-packages, but many packages
can be found on GitHub and if you want the development version of a
package you likely need to get it from GitHub or other place outside CRAN.
You would then either download and install manually or install with
something like devtools, from within R.</p></li>
</ul>
</div>
</section>
</section>
<section id="install-own-packages-on-bianca">
<h2>Install own packages on Bianca<a class="headerlink" href="#install-own-packages-on-bianca" title="Link to this heading"></a></h2>
<ul>
<li><p>If an R package is not not available on Bianca already (like Conda repositories) you may have to use the wharf to install the library/package</p></li>
<li><p>Typical workflow</p>
<blockquote>
<div><ul class="simple">
<li><p>Install on Rackham</p></li>
<li><p>Transfer to Wharf</p></li>
<li><p>Move package to local Bianca R package path</p></li>
<li><p>Test your installation</p></li>
</ul>
</div></blockquote>
</li>
<li><dl class="simple">
<dt>Demo and exercise from our Bianca course:</dt><dd><ul class="simple">
<li><p><a class="reference external" href="https://uppmax.github.io/bianca_workshop/extra/rpackages/">Installing R packages on Bianca</a></p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../extra/isolated_extra.html" class="btn btn-neutral float-left" title="Isolated environments, extra exercises" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="packagesBianca.html" class="btn btn-neutral float-right" title="Packages at Bianca (parallel session)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, UPPMAX &amp; HPC2N.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>